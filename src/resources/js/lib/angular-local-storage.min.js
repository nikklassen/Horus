(function(b,a,c){a.module("angularLocalStorage",["ngCookies"]).factory("storage",["$parse","$cookieStore","$window","$log",function(g,m,f,n){var k=(typeof f.localStorage==="undefined")?c:f.localStorage;var d=!(typeof k==="undefined");var i={};if(d){var l="__"+Math.round(Math.random()*10000000);try{localStorage.setItem(l,l);localStorage.removeItem(l)}catch(h){d=false}}var e={parseValue:function(o){var q;try{q=a.fromJson(o);if(typeof q==="undefined"){q=o}if(q==="true"){q=true}if(q==="false"){q=false}if(f.parseFloat(q)===q&&!a.isObject(q)){q=f.parseFloat(q)}}catch(p){q=o}return q},getWatcherId:function(p,o){return p.$id+o}};var j={set:function(p,q){if(!d){try{m.put(p,q);return q}catch(r){n.log("Local Storage not supported, make sure you have angular-cookies enabled.")}}var o=a.toJson(q);k.setItem(p,o);return e.parseValue(o)},get:function(o){if(!d){try{return m.get(o)}catch(q){return null}}var p=k.getItem(o);return e.parseValue(p)},remove:function(o){if(!d){try{m.remove(o);return true}catch(p){return false}}k.removeItem(o);return true},bind:function(q,s,u){var p=e.getWatcherId(q,s);var o={defaultValue:"",storeName:""};if(a.isString(u)){u=a.extend({},o,{defaultValue:u})}else{u=(a.isUndefined(u))?o:a.extend(o,u)}var r=u.storeName||s;var t=q.$eval(s);if(j.get(r)===null&&typeof t==="undefined"){j.set(r,u.defaultValue)}if(typeof t==="undefined"){g(s).assign(q,j.get(r))}i[p]=q.$watch(s,function(v){if(a.isDefined(v)){j.set(r,v)}},true);return j.get(r)},unbind:function(p,r,q){var o=e.getWatcherId(p,r);q=q||r;g(r).assign(p,null);j.remove(q);if(i[o]){i[o]();delete i[o]}},clearAll:function(){k.clear()},isCookieFallbackActive:function(){return !d}};return j}])})(window,window.angular);
